{"ast":null,"code":"import { useLayoutEffect, useEffect } from 'react';\n\nfunction dispatchEvent(type, detail) {\n  window.dispatchEvent(new CustomEvent(type, {\n    detail\n  }));\n}\n\nconst useIsomorphicEffect = typeof window !== \"undefined\" ? useLayoutEffect : useEffect;\n\nfunction createUseExternalEvents(prefix) {\n  function _useExternalEvents(events) {\n    const handlers = Object.keys(events).reduce((acc, eventKey) => {\n      acc[`${prefix}:${eventKey}`] = event => events[eventKey](event.detail);\n\n      return acc;\n    }, {});\n    useIsomorphicEffect(() => {\n      Object.keys(handlers).forEach(eventKey => {\n        window.removeEventListener(eventKey, handlers[eventKey]);\n        window.addEventListener(eventKey, handlers[eventKey]);\n      });\n      return () => Object.keys(handlers).forEach(eventKey => {\n        window.removeEventListener(eventKey, handlers[eventKey]);\n      });\n    }, []);\n  }\n\n  function createEvent(event) {\n    return (...payload) => dispatchEvent(`${prefix}:${String(event)}`, payload[0]);\n  }\n\n  return [_useExternalEvents, createEvent];\n}\n\nexport { createUseExternalEvents };","map":{"version":3,"sources":["../../src/create-use-external-events/create-use-external-events.ts"],"names":[],"mappings":";;AACA,SAAS,aAAT,CAAuB,IAAvB,EAA6B,MAA7B,EAAqC;AACnC,EAAA,MAAM,CAAC,aAAP,CAAqB,IAAI,WAAJ,CAAgB,IAAhB,EAAsB;AAAE,IAAA;AAAF,GAAtB,CAArB;AACD;;AACD,MAAM,mBAAmB,GAAG,OAAO,MAAP,KAAkB,WAAlB,GAAgC,eAAhC,GAAkD,SAA9E;;AACO,SAAS,uBAAT,CAAiC,MAAjC,EAAyC;AAC9C,WAAS,kBAAT,CAA4B,MAA5B,EAAoC;AAClC,UAAM,QAAQ,GAAG,MAAM,CAAC,IAAP,CAAY,MAAZ,EAAoB,MAApB,CAA2B,CAAC,GAAD,EAAM,QAAN,KAAmB;AAC7D,MAAA,GAAG,CAAE,GAAE,MAAO,IAAG,QAAS,EAAvB,CAAH,GAAgC,KAAD,IAAW,MAAM,CAAC,QAAD,CAAN,CAAiB,KAAK,CAAC,MAAvB,CAA1C;;AACA,aAAO,GAAP;AACD,KAHgB,EAGd,EAHc,CAAjB;AAIA,IAAA,mBAAmB,CAAC,MAAM;AACxB,MAAA,MAAM,CAAC,IAAP,CAAY,QAAZ,EAAsB,OAAtB,CAA+B,QAAD,IAAc;AAC1C,QAAA,MAAM,CAAC,mBAAP,CAA2B,QAA3B,EAAqC,QAAQ,CAAC,QAAD,CAA7C;AACA,QAAA,MAAM,CAAC,gBAAP,CAAwB,QAAxB,EAAkC,QAAQ,CAAC,QAAD,CAA1C;AACD,OAHD;AAIA,aAAO,MAAM,MAAM,CAAC,IAAP,CAAY,QAAZ,EAAsB,OAAtB,CAA+B,QAAD,IAAc;AACvD,QAAA,MAAM,CAAC,mBAAP,CAA2B,QAA3B,EAAqC,QAAQ,CAAC,QAAD,CAA7C;AACD,OAFY,CAAb;AAGD,KARkB,EAQhB,EARgB,CAAnB;AASD;;AACD,WAAS,WAAT,CAAqB,KAArB,EAA4B;AAC1B,WAAO,CAAC,GAAG,OAAJ,KAAgB,aAAa,CAAE,GAAE,MAAO,IAAG,MAAM,CAAC,KAAD,CAAQ,EAA5B,EAA+B,OAAO,CAAC,CAAD,CAAtC,CAApC;AACD;;AACD,SAAO,CAAC,kBAAD,EAAqB,WAArB,CAAP;AACF","sourcesContent":["import { useEffect, useLayoutEffect } from 'react';\n\nfunction dispatchEvent<T>(type: string, detail?: T) {\n  window.dispatchEvent(new CustomEvent(type, { detail }));\n}\n\nconst useIsomorphicEffect = typeof window !== 'undefined' ? useLayoutEffect : useEffect;\n\nexport function createUseExternalEvents<Handlers extends Record<string, (detail: any) => void>>(\n  prefix: string\n) {\n  function _useExternalEvents(events: Handlers) {\n    const handlers = Object.keys(events).reduce((acc, eventKey) => {\n      acc[`${prefix}:${eventKey}`] = (event: CustomEvent) => events[eventKey](event.detail);\n      return acc;\n    }, {});\n\n    useIsomorphicEffect(() => {\n      Object.keys(handlers).forEach((eventKey) => {\n        window.removeEventListener(eventKey, handlers[eventKey]);\n        window.addEventListener(eventKey, handlers[eventKey]);\n      });\n\n      return () =>\n        Object.keys(handlers).forEach((eventKey) => {\n          window.removeEventListener(eventKey, handlers[eventKey]);\n        });\n    }, []);\n  }\n\n  function createEvent<EventKey extends keyof Handlers>(event: EventKey) {\n    type Parameter = Parameters<Handlers[EventKey]>[0];\n\n    return (...payload: Parameter extends undefined ? [undefined?] : [Parameter]) =>\n      dispatchEvent(`${prefix}:${String(event)}`, payload[0]);\n  }\n\n  return [_useExternalEvents, createEvent] as const;\n}\n"]},"metadata":{},"sourceType":"module"}