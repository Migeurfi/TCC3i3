{"ast":null,"code":"import { findElementAncestor } from '../find-element-ancestor/find-element-ancestor.js';\n\nfunction getPreviousIndex(current, elements, loop) {\n  for (let i = current - 1; i >= 0; i -= 1) {\n    if (!elements[i].disabled) {\n      return i;\n    }\n  }\n\n  if (loop) {\n    for (let i = elements.length - 1; i > -1; i -= 1) {\n      if (!elements[i].disabled) {\n        return i;\n      }\n    }\n  }\n\n  return current;\n}\n\nfunction getNextIndex(current, elements, loop) {\n  for (let i = current + 1; i < elements.length; i += 1) {\n    if (!elements[i].disabled) {\n      return i;\n    }\n  }\n\n  if (loop) {\n    for (let i = 0; i < elements.length; i += 1) {\n      if (!elements[i].disabled) {\n        return i;\n      }\n    }\n  }\n\n  return current;\n}\n\nfunction onSameLevel(target, sibling, parentSelector) {\n  return findElementAncestor(target, parentSelector) === findElementAncestor(sibling, parentSelector);\n}\n\nfunction createScopedKeydownHandler({\n  parentSelector,\n  siblingSelector,\n  onKeyDown,\n  loop = true,\n  activateOnFocus = false,\n  dir = \"rtl\",\n  orientation\n}) {\n  return event => {\n    var _a;\n\n    onKeyDown == null ? void 0 : onKeyDown(event);\n    const elements = Array.from(((_a = findElementAncestor(event.currentTarget, parentSelector)) == null ? void 0 : _a.querySelectorAll(siblingSelector)) || []).filter(node => onSameLevel(event.currentTarget, node, parentSelector));\n    const current = elements.findIndex(el => event.currentTarget === el);\n\n    const _nextIndex = getNextIndex(current, elements, loop);\n\n    const _previousIndex = getPreviousIndex(current, elements, loop);\n\n    const nextIndex = dir === \"rtl\" ? _previousIndex : _nextIndex;\n    const previousIndex = dir === \"rtl\" ? _nextIndex : _previousIndex;\n\n    switch (event.key) {\n      case \"ArrowRight\":\n        {\n          if (orientation === \"horizontal\") {\n            event.stopPropagation();\n            event.preventDefault();\n            elements[nextIndex].focus();\n            activateOnFocus && elements[nextIndex].click();\n          }\n\n          break;\n        }\n\n      case \"ArrowLeft\":\n        {\n          if (orientation === \"horizontal\") {\n            event.stopPropagation();\n            event.preventDefault();\n            elements[previousIndex].focus();\n            activateOnFocus && elements[previousIndex].click();\n          }\n\n          break;\n        }\n\n      case \"ArrowUp\":\n        {\n          if (orientation === \"vertical\") {\n            event.stopPropagation();\n            event.preventDefault();\n\n            elements[_previousIndex].focus();\n\n            activateOnFocus && elements[_previousIndex].click();\n          }\n\n          break;\n        }\n\n      case \"ArrowDown\":\n        {\n          if (orientation === \"vertical\") {\n            event.stopPropagation();\n            event.preventDefault();\n\n            elements[_nextIndex].focus();\n\n            activateOnFocus && elements[_nextIndex].click();\n          }\n\n          break;\n        }\n\n      case \"Home\":\n        {\n          event.stopPropagation();\n          event.preventDefault();\n          !elements[0].disabled && elements[0].focus();\n          break;\n        }\n\n      case \"End\":\n        {\n          event.stopPropagation();\n          event.preventDefault();\n          const last = elements.length - 1;\n          !elements[last].disabled && elements[last].focus();\n          break;\n        }\n    }\n  };\n}\n\nexport { createScopedKeydownHandler };","map":{"version":3,"sources":["../../src/create-scoped-keydown-handler/create-scoped-keydown-handler.ts"],"names":[],"mappings":"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","sourcesContent":["import { findElementAncestor } from '../find-element-ancestor/find-element-ancestor';\n\nfunction getPreviousIndex(current: number, elements: HTMLButtonElement[], loop: boolean) {\n  for (let i = current - 1; i >= 0; i -= 1) {\n    if (!elements[i].disabled) {\n      return i;\n    }\n  }\n\n  if (loop) {\n    for (let i = elements.length - 1; i > -1; i -= 1) {\n      if (!elements[i].disabled) {\n        return i;\n      }\n    }\n  }\n\n  return current;\n}\n\nfunction getNextIndex(current: number, elements: HTMLButtonElement[], loop: boolean) {\n  for (let i = current + 1; i < elements.length; i += 1) {\n    if (!elements[i].disabled) {\n      return i;\n    }\n  }\n\n  if (loop) {\n    for (let i = 0; i < elements.length; i += 1) {\n      if (!elements[i].disabled) {\n        return i;\n      }\n    }\n  }\n\n  return current;\n}\n\n/** Validates that target element is on the same level as sibling, used to filter out children that have the same sibling selector */\nfunction onSameLevel(\n  target: HTMLButtonElement,\n  sibling: HTMLButtonElement,\n  parentSelector: string\n) {\n  return (\n    findElementAncestor(target, parentSelector) === findElementAncestor(sibling, parentSelector)\n  );\n}\n\ninterface GetElementsSiblingsInput {\n  /** Selector used to find parent node, e.g. '[role=\"tablist\"]', '.mantine-Text-root' */\n  parentSelector: string;\n\n  /** Selector used to find element siblings, e.g. '[data-tab]' */\n  siblingSelector: string;\n\n  /** Determines whether next/previous indices should loop */\n  loop?: boolean;\n\n  /** Determines which arrow keys will be used */\n  orientation: 'vertical' | 'horizontal';\n\n  /** Text direction */\n  dir?: 'rtl' | 'ltr';\n\n  /** Determines whether element should be clicked when focused with keyboard event */\n  activateOnFocus?: boolean;\n\n  /** External keydown event */\n  onKeyDown?(event: React.KeyboardEvent<HTMLButtonElement>): void;\n}\n\nexport function createScopedKeydownHandler({\n  parentSelector,\n  siblingSelector,\n  onKeyDown,\n  loop = true,\n  activateOnFocus = false,\n  dir = 'rtl',\n  orientation,\n}: GetElementsSiblingsInput) {\n  return (event: React.KeyboardEvent<HTMLButtonElement>) => {\n    onKeyDown?.(event);\n\n    const elements = Array.from(\n      findElementAncestor(event.currentTarget, parentSelector)?.querySelectorAll<HTMLButtonElement>(\n        siblingSelector\n      ) || []\n    ).filter((node) => onSameLevel(event.currentTarget, node, parentSelector));\n\n    const current = elements.findIndex((el) => event.currentTarget === el);\n    const _nextIndex = getNextIndex(current, elements, loop);\n    const _previousIndex = getPreviousIndex(current, elements, loop);\n    const nextIndex = dir === 'rtl' ? _previousIndex : _nextIndex;\n    const previousIndex = dir === 'rtl' ? _nextIndex : _previousIndex;\n\n    switch (event.key) {\n      case 'ArrowRight': {\n        if (orientation === 'horizontal') {\n          event.stopPropagation();\n          event.preventDefault();\n          elements[nextIndex].focus();\n          activateOnFocus && elements[nextIndex].click();\n        }\n\n        break;\n      }\n\n      case 'ArrowLeft': {\n        if (orientation === 'horizontal') {\n          event.stopPropagation();\n          event.preventDefault();\n          elements[previousIndex].focus();\n          activateOnFocus && elements[previousIndex].click();\n        }\n\n        break;\n      }\n\n      case 'ArrowUp': {\n        if (orientation === 'vertical') {\n          event.stopPropagation();\n          event.preventDefault();\n          elements[_previousIndex].focus();\n          activateOnFocus && elements[_previousIndex].click();\n        }\n\n        break;\n      }\n\n      case 'ArrowDown': {\n        if (orientation === 'vertical') {\n          event.stopPropagation();\n          event.preventDefault();\n          elements[_nextIndex].focus();\n          activateOnFocus && elements[_nextIndex].click();\n        }\n\n        break;\n      }\n\n      case 'Home': {\n        event.stopPropagation();\n        event.preventDefault();\n        !elements[0].disabled && elements[0].focus();\n        break;\n      }\n\n      case 'End': {\n        event.stopPropagation();\n        event.preventDefault();\n        const last = elements.length - 1;\n        !elements[last].disabled && elements[last].focus();\n        break;\n      }\n    }\n  };\n}\n"]},"metadata":{},"sourceType":"module"}